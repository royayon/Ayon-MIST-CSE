INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000001','Ataul Islam', 'Male', 'O+', to_date('16-12-1975','DD-MM-YYYY'),'Bangladeshi','ataul@yahoo.','01789332846');INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000002','Sharifa Mahmud', 'Female', 'A+', to_date('03-10-1984','DD-MM-YYYY'),'Bangladeshi','sharifa@gail.com','01755091692');INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000003','Rajesh Rahman', 'Male', 'B+', to_date('11-04-1990','DD-MM-YYYY'),'Bangladeshi','rajesh_rahman@gmail.com','01989300472');INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000004','Shahriar Mamun', 'Male', 'B+', to_date('14-01-1978','DD-MM-YYYY'),'Bangladeshi','shahriar@yahoo.com','0176400102');INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000005','Nasrin Ahmed', 'Female', 'O+', to_date('17-08-1986','DD-MM-YYYY'),'Bangladeshi','nasrin@gmail.com','01859034546');INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000006','Mishkat Bari', 'Male', 'A+', to_date('06-03-1990','DD-MM-YYYY'),'Bangladeshi','mishkat@gmail.com','01740889916');INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000007','Obin Barek', 'Male', 'A+', to_date('24-10-2010','DD-MM-YYYY'),'Bangladeshi','','017555812');INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000008','Mithila Rayhan', 'Female', 'A-', to_date('17-08-1986','DD-MM-YYYY'),'Bangladeshi','@gmail.com','01554012362');INSERT INTO Patient (Patient_id, Name, Gender, Blood_group, Date_of_birth, Nationality, Email, Phone) VALUES ('P_0000009','Saklain Monir', 'Male', 'O-', to_date('06-03-1990','DD-MM-YYYY'),'Bangladeshi','saklain@ymail.com','01768681244');INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000001', to_date('21-03-2018','DD-MM-YYYY'), 'High 140, Low 90','5.3 mmol/L', 80, 5.9);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000002', to_date('25-03-2018','DD-MM-YYYY'), 'High 100, Low 60','6.2 mmol/L', 80, 5.2);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000003', to_date('27-03-2018','DD-MM-YYYY'), 'High 120, Low 80','8.0 mmol/L', 80, 6.1);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000004', to_date('28-03-2018','DD-MM-YYYY'), 'High 130, Low 90','4.8 mmol/L', 80, 5.9);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000005', to_date('28-03-2018','DD-MM-YYYY'), 'High 150, Low 90','5.7 mmol/L', 80, 5.10);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000006', to_date('29-03-2018','DD-MM-YYYY'), 'High 120, Low 60','9.2 mmol/L', 80, 5.5);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000007', to_date('29-03-2018','DD-MM-YYYY'), 'High 130, Low 70','3.1 mmol/L', 80, 5.7);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000008', to_date('30-03-2018','DD-MM-YYYY'), 'High 110, Low 60','3.3 mmol/L', 45, 5.8);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000009', to_date('01-04-2018','DD-MM-YYYY'), 'High 130, Low 90','8.5 mmol/L', 80, 5.9);INSERT INTO Admitted_Patient_Record (Admission_id, Record_date, Blood_Pressure, Blood_Sugar, Weight, Height) VALUES ('A_0000010', to_date('02-04-2018','DD-MM-YYYY'), 'High 130, Low 80','10.1 mmol/L', 80, 6.2);INSERT INTO Performed_By (Doc_Id, Operation_id, Operation_date) VALUES ('D_0000002','O_0000001',to_date('28-03-2018','DD-MM-YYYY'));INSERT INTO Performed_By (Doc_Id, Operation_id, Operation_date) VALUES ('D_0000009','O_0000001',to_date('29-03-2018','DD-MM-YYYY'));INSERT INTO Performed_By (Doc_Id, Operation_id, Operation_date) VALUES ('D_0000007','O_0000002',to_date('29-03-2018','DD-MM-YYYY'));INSERT INTO Performed_By (Doc_Id, Operation_id, Operation_date) VALUES ('D_0000010','O_0000001',to_date('02-04-2018','DD-MM-YYYY'));INSERT INTO Performed_By (Doc_Id, Operation_id, Operation_date) VALUES ('D_0000005','O_0000001',to_date('03-04-2018','DD-MM-YYYY'));INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000006','A_0000001');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000001','A_0000002');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000009','A_0000003');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000002','A_0000004');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000003','A_0000005');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000001','A_0000006');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000007','A_0000007');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000004','A_0000008');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000001','A_0000009');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000005','A_0000010');INSERT INTO Treats_the_Admitted     (Doc_id, Admission_id) VALUES ('D_0000003','A_0000011');​INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000001','Stomach Ache', to_date('20-04-2018','DD-MM-YYYY'), to_date('23-04-2018','DD-MM-YYYY'), 307, 6000);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000002','Dengu', to_date('24-04-2018','DD-MM-YYYY'),to_date('01-05-2018','DD-MM-YYYY'), 201,24000);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000003','Broken Leg', to_date('27/03/2018','DD/MM/YYYY'), to_date('01-04-2018','DD-MM-YYYY'),203, 18000);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000004','Labor Pain', to_date('28-04-2018','DD-MM-YYYY'), to_date('30/04/2018','DD/MM/YYYY'), 505, 9000);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000005','Stroke', to_date('28-04-2018','DD-MM-YYYY'),NULL, 307, 12000);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000006','Typhoid', to_date('28-04-2018','DD-MM-YYYY'),NULL,203, 12000);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000007','Tonsil Infection', to_date('28-03-2018','DD-MM-YYYY'), to_date('02-04-2018','DD-MM-YYYY'), 404, 14000);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000008','Pneumonia', to_date('29-03-2018','DD-MM-YYYY'),NULL,304, 9000);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000009','Kidney Stone', to_date('29-03-2018','DD-MM-YYYY'),NULL,402, 5500);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000010','Kidney Stone', to_date('31-03-2018','DD-MM-YYYY'),NULL,401, 5500);INSERT INTO Admission (Admission_id, Admission_reason, Admission_date,Release_date, Room_no, admission_fees) VALUES ('A_0000011','Spinal Cord Tumor', to_date('01-04-2018','DD-MM-YYYY'),NULL, 305, 3000);INSERT INTO Admitted_Patient_Operation (Admission_id, Operation_id, Operation_date ) VALUES ('A_0000004','O_0000001',to_date('28-03-2018','DD-MM-YYYY'));INSERT INTO Admitted_Patient_Operation (Admission_id, Operation_id, Operation_date ) VALUES ('A_0000003','O_0000001',to_date('29-03-2018','DD-MM-YYYY'));INSERT INTO Admitted_Patient_Operation (Admission_id, Operation_id, Operation_date ) VALUES ('A_0000007','O_0000002',to_date('29-03-2018','DD-MM-YYYY'));INSERT INTO Admitted_Patient_Operation (Admission_id, Operation_id, Operation_date ) VALUES ('A_0000010','O_0000001',to_date('02-04-2018','DD-MM-YYYY'));INSERT INTO Admitted_Patient_Operation (Admission_id, Operation_id, Operation_date ) VALUES ('A_0000009','O_0000001',to_date('03-04-2018','DD-MM-YYYY'));INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000001','A_0000001');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000005','A_0000002');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000003','A_0000003');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000002','A_0000004');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000004','A_0000005');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000006','A_0000006');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000008','A_0000007');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000007','A_0000008');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000001','A_0000009');INSERT INTO Admitted_Patient (Patient_id, Admission_Id) VALUES ('P_0000009','A_0000010');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000001','sabbir Rahman', 'Medicine', 'Sabbir@gmail.com','01740917774', to_date('09-12-1975','DD-MM-YYYY'), to_date('27-02-2002','DD-MM-YYYY'),'General Department','');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000002','Marzuka Rasel', 'Gynecologist', 'Marzuka@gmail.com','01792215789', to_date('13-06-1982','DD-MM-YYYY'), to_date('19-07-2007','DD-MM-YYYY'),'Gynecology Department','D_0000005');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000003','Hakim Ahmed', 'Neurosurgeon', 'Hakim@gmail.com','01939455001', to_date('23-04-1979','DD-MM-YYYY'), to_date('18-09-2007','DD-MM-YYYY'),'Neurology Department','D_0000002');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000004','amena Begum', 'Pediatrics', 'Amena@gmail.com','01720917646', to_date('09-12-1980','DD-MM-YYYY'), to_date('17-04-2005','DD-MM-YYYY'),'Children Department','D_0000003');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000005','Wahab Siddique', 'surgeon', 'Wahab@gmail.com','01944026555', to_date('01-02-1981','DD-MM-YYYY'), to_date('05-09-2008','DD-MM-YYYY'),'Surgery Department','D_0000001');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000006','Zobaida Ali', 'Medicine', 'Zobaida@gmail.com','01556012947', to_date('09-07-1990','DD-MM-YYYY'), to_date('09-07-2013','DD-MM-YYYY'),'General Department','D_0000004');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000007','Ratul Bishwash', 'surgeon', 'Ratul@gmail.com','01770501241', to_date('21-09-1991','DD-MM-YYYY'), to_date('09-07-2014','DD-MM-YYYY'),'Surgery Department','D_0000006');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000008','Nusrat Zebin', 'Gynecologist', 'Nusrat@gmail.com','01840117664', to_date('28-03-1992','DD-MM-YYYY'), to_date('09-07-2014','DD-MM-YYYY'),'Gynecology Department','');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000009','Shaila Kader', 'surgeon', 'Shaila@gmail.com','01681045232', to_date('28-04-1980','DD-MM-YYYY'), to_date('11-01-2005','DD-MM-YYYY'),'Surgery Department','D_0000008');INSERT INTO Doctor (Doc_id, Name, Speciality, Email, Phone, Date_of_birth, Joining_date, Department, Assistant_of) VALUES ('D_0000010','Faisal Rabbi', 'Neurosurgeon', 'Faisal@gmail.com','01760124936', to_date('16-12-1984','DD-MM-YYYY'), to_date('20-01-2010','DD-MM-YYYY'),'Neurology Department','D_0000009');INSERT INTO Operation (Operation_id, Operation_name, Operation_date, Operation_room, Operation_result) VALUES ('O_0000001','Baby Delivery', to_date('28-03-2018','DD-MM-YYYY'),'OT-02','Successful');INSERT INTO Operation (Operation_id, Operation_name, Operation_date, Operation_room, Operation_result) VALUES ('O_0000001','Broken Leg Operation', to_date('29-03-2018','DD-MM-YYYY'),'OT-01','Successful');INSERT INTO Operation (Operation_id, Operation_name, Operation_date, Operation_room, Operation_result) VALUES ('O_0000002','Tonsil Operation', to_date('29-03-2018','DD-MM-YYYY'),'OT-04','Successful');INSERT INTO Operation (Operation_id, Operation_name, Operation_date, Operation_room, Operation_result) VALUES ('O_0000001','Tumor Operation', to_date('02-04-2018','DD-MM-YYYY'),'OT-01','Unsuccessful');INSERT INTO Operation (Operation_id, Operation_name, Operation_date, Operation_room, Operation_result) VALUES ('O_0000001','Kidney Stone Operation', to_date('03-04-2018','DD-MM-YYYY'),'OT-03','Pending');


SELECT P.NAME "Patient Name", D.NAME "Doctor name", (A.Release_date-A.Admission_date) "Number of days stayed"
FROM Patient P
JOIN Admitted_Patient AP ON P.Patient_id = AP.Patient_id
JOIN Admission A ON AP.Admission_id = A.Admission_id
JOIN Treats_the_Admitted TA ON AP.Admission_id = TA.Admission_id
JOIN Doctor D TA.Doc_id = D.Doc_id 
;

SELECT D.Name "Doctor", A.Name "Assistant Doctor", A.Admission_date "Date of Admission", A.Admission_fees "Total Fees", (A.Admission_fees * .75) "Doctor Fees", (A.Admission_fees * .75 * .15) "Assistant Doctor Fees"
FROM Doctor D
JOIN Doctor A ON A.Assistant_of = D.Doc_id 
JOIN Treats_the_Admitted TA ON D.Doc_id =TA.Doc_id 
JOIN Admission A ON TA.Admission_id = A.Admission_id 
;

SELECT P.Name "Patient Name", O.Operation_result "Operation Result", P.Gender "Gender", P.Blood_group "Blood Group", APR.Blood_Sugar "Blood Suger", APR.Height "Height", APR.Weight "Weight", FLOOR((TO_DATE('10-04-2019','DD-MM-YYYY')-P.Date_of_birth)/365) "Age"
FROM Patient P
JOIN Admitted_Patient USING(Patient_id)
JOIN Admission USING(Admission_id)
JOIN Admitted_Patient_Operation USING(Admission_id)
JOIN Operation O USING(Operation_id)
JOIN Admitted_Patient_Record APR USING(Admission_id)
JOIN Treats_the_Admitted USING(Admission_id )
JOIN Doctor D USING(Doc_id )
WHERE D.Department = 'Neurology Department'
AND O.Operation_date = TO_DATE('29-03-2018','DD-MM-YYYY')
AND P.Gender = 'Male'
;